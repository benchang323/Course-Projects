#include <iostream>
#include <ctime>
#include <string>
using namespace std;

const int size = 10;
const int size = 10;

int maxships = 12;

string matrix[size][size];
string playerboard[size][size];

void Clear()
{
	for(int i=0; i < size; i++)
	{
		for(int j=0; j < size; j++)
		{
			matrix[i][j] = "O";
      		playerboard[i][j] = "O";
		}
	}
}

void Showendgame()
{
	for(int i=0; i < size; i++)
	{
		for(int j=0; j < size; j++)
		{
			cout << matrix[i][j] << " ";
		}
		cout << endl;
	}
}

void Showplayer()
{
	for(int i=0; i < size; i++)
	{
		for(int j=0; j < size; j++)
		{
			//cout << playerboard[i][j] << " ";
      if(playerboard[i][j] == "I"){
        cout << " ⛵ ";
      }
      if(playerboard[i][j] == "O"){
        cout << " 🌊 ";
      }
      if(playerboard[i][j] == "✓"){
        cout << " 💥 ";
      }
      if(playerboard[i][j] == "X"){
        cout << " ❌ ";
      }
		}
		cout << endl;
	}
}

void Shownpc()
{
	for(int i=0; i < size; i++)
	{
		for(int j=0; j < size; j++)
		{
      if (matrix[i][j] == "I" || matrix[i][j] == "O"){
        cout << " 🌊 ";
      }
			else if (matrix[i][j] == "✓"){
        cout << " 💥 ";
      }
      else{
        cout << " ❌ ";
      }
      
		}
		cout << endl;
	}
}

int NumberOfNPCShips()
{
	int c = 0;

	for(int i=0; i < size; i++)
	{
		for(int j=0; j < size; j++)
		{
			if(matrix[i][j] == "I")
				c++;
		}
	}

	return c;
}

int NumberOfPlayerShips()
{
	int c = 0;

	for(int i=0; i < size; i++)
	{
		for(int j=0; j < size; j++)
		{
			if(playerboard[i][j] == "I")
				c++;
		}
	}

	return c;
}

void SetShips()
{
	int s = 0;
	while(s < maxships)
	{
		int x = rand() % size;
		int y = rand() % size;
		if(matrix[x][y] != "I")
		{
			s++;
			matrix[x][y] = "I";
		}
	}
  s = 0;
  while(s < maxships)
	{
		int x = rand() % size;
		int y = rand() % size;
		if(playerboard[x][y] != "I")
		{
			s++;
			playerboard[x][y] = "I";
		}
	}
}

bool AiAttack(){
  int x = rand() % size;
	int y = rand() % size;
  if(playerboard[x][y] == "I")
	{
		playerboard[x][y] = "✓";
		return true;
	}
  else{
    playerboard[x][y] = "X";
    return false;
  }
}

bool Attack(int x,int y)
{
	if(matrix[x][y] == "I")
	{
		matrix[x][y] = "✓";
		return true;
	}
  else{
    matrix[x][y] = "X";
    return false;
  }
	
}

int main()
{
	srand(time(NULL));
	Clear();
	SetShips();
	int pos1,pos2;
  Showplayer();
  cout<<"\n\"🛥\" is your ships\n";
  cout<<"\n\"🌊 \" is the sea! it means you don't know whether if there is an opponent's ship or not in that block\n\n";
  cout<<"\"💥\" means you have hit a ship with your cannon\n\n";
  cout<<"\"❌\" means you missed\n\n";
  cout<<"THE GAME HAS STARTED!! FIRE!!!!!!\n\n";
  cout<<"This is your autogenerated board: \n";
	while(1)
	{
    cout<<"Your fleet: \n";
    Showplayer();
    cout<<"\n";
    cout<<"Known Enemy's fleet: \n";
    Shownpc();
    while(1){
      cout << "Please input location: "; cin >> pos1 >> pos2;
      if (pos1 >= 0 && pos2 >= 0 && pos1 <= size && pos2 <= size) {
        break;
      }
    }

		if(Attack(pos1,pos2)){
      cout << "You got me! :)\n" << endl;
    }
		else{
      cout << "Sorry no ship at that position!\n" << endl;
    }
    cout<<"Known Enemy's fleet: \n";
    Shownpc();
		cout << "Number of opponent's ships left: " << NumberOfNPCShips() << endl;

    if (NumberOfNPCShips() == 0){
      cout<<"YOU WIN\n";
      break;
    }

    cout << "Opponent's turn!!\n\n";
    if(AiAttack()){
      cout << "Haha I got you!\n\n";
    }
    else{
      cout << "Awwww I missed\n\n";
    }

    cout << "Number of your ships left: " << NumberOfPlayerShips() << endl;

    if (NumberOfPlayerShips() == 0){
      cout<<"YOU LOSE\n";
      break;
    }
	cout << "Game over!" << endl;
	return 0;
}